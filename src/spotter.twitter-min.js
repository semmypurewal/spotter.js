if(!spotter){throw new Error("spotter not yet loaded!")}if(!spotter.modules){spotter.modules={}}else{if(typeof spotter.modules!="object"){throw new Error("spotter.modules is not an object!")}}if(!spotter.modules.twitter){spotter.modules.twitter={}}else{if(typeof spotter.modules.twitter!="object"){throw new Error("spotter.modules.twitter is not an object!")}}spotter.modules.twitter.search=function(d){var c="";var b=d.searchString;if(b==undefined||b==""){throw new Error("twitter search module requires searchString to be specified as an option")}var a=function(){var g="http://search.twitter.com/search.json";g+=c!=""?c:"?q="+escape(b);return g};var f=function(g){c=g.refresh_url;if(g.results.length>0){g.results.update=true}return g.results};var e={};e.url=a;e.callback=f;return e};spotter.modules.twitter.trends=function(b){var e;var a=function(){var h="http://search.twitter.com/trends.json?";if(b!=undefined&&b.exclude!=undefined){h+="exclude="+b.exclude}return h};var g=function(h){var k=h.trends;if(e==null){result={added:k,removed:{},trends:k}}else{var i=f(k,e);var j=d(k,e);result={added:i[0],removed:i[1],trends:k,changes:j}}e=k;if(result.added.length>0||result.removed.length>0){result.update=true}return result};function d(k,j){var h=new Array();var m=new Object();for(var l in j){m[j[l]]==undefined?m[j[l]["name"]]=parseInt(l):null}for(var l in k){h[l]=m[k[l]["name"]]==undefined?-1:m[k[l]["name"]]}return h}function f(l,h){var p=new Object();var q=new Array();var r=new Array();for(var o in l){p[l[o]]==undefined?p[l[o]["name"]]=o:null}for(var n in h){p[h[n]["name"]]==null?r.push(h[n]):p[h[n]["name"]]=-1}for(var m in p){p[m]>=0?q.push(l[p[m]]):null}return[q,r]}var c={};c.url=a;c.callback=g;return c};
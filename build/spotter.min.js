(function(b){var a={};a.Spotter=function(m,n){a.Spotter.instanceCount=(a.Spotter.instanceCount===undefined)?1:a.Spotter.instanceCount+1;var h="_so"+a.Spotter.instanceCount;var o=false;var j=true;var k=null;var i=[];var c=null;var d;b.spotterjs[h]=this;if(!a.modules[m.split(".")[0]]||!a.modules[m.split(".")[0]][m.split(".")[1]]){throw new Error("Spotter: Module "+m+" not found! (Did you remember to include it via a script tag?)")}try{d=new (b.spotterjs["modules"][m.split(".")[0]][m.split(".")[1]])(n)}catch(l){throw new Error(l)}if(!d.url||!d.process){throw new Error("Spotter: spotterjs.modules."+m+" is invalid.  (Does it return an object with url and process methods?)")}this.start=function(){if(!o){o=true}var e;var p=this;if(j){e=d.url();if(e instanceof Object&&e.callbackParam!==undefined){e=e.url+"&"+e.callbackParam+"=spotterjs."+h+".callback"}else{e+="&callback=spotterjs."+h+".callback"}e+="&random="+Math.floor(Math.random()*10000);g(e)}if(d.nextTimeout()>0){c=setTimeout(function(){p.start()},d.nextTimeout()*1000)}};this.callback=function(p){var e=d.process(p);if(e.update){f(e.data)}j=true};this.stop=function(){if(!o){throw new Error("Spotter: You can't stop a stopped spotter!")}else{o=false;var e=document.getElementsByTagName("head");if(k){e[0].removeChild(k)}clearTimeout(c)}};var g=function(p){var q=document.getElementsByTagName("head");var e=document.createElement("script");e.id=h+"_request";e.type="text/javascript";e.src=p;if(k){q[0].removeChild(k)}q[0].appendChild(e);k=e};this.register=function(e){if(e!==undefined&&e.notify!==undefined&&typeof e.notify==="function"){i.push(e)}else{if(e!==undefined&&typeof e==="function"){i.push(e)}else{throw new TypeError("Observer must implement a notify method.")}}};var f=function(p){for(var e in i){if(typeof i[e]==="object"){i[e].notify(p)}else{if(typeof i[e]==="function"){i[e](p)}else{throw new Error("observer list contains an invalid object")}}}}};a.util={};a.util.changes=function(e,d){var c=new Array();var g=new Object();for(var f in d){g[d[f]]==undefined?g[d[f]["name"]]=parseInt(f):null}for(var f in e){c[f]=g[e[f]["name"]]==undefined?-1:g[e[f]["name"]]}return c};a.util.complements=function(d,c){var h=new Object();var l=new Array();var m=new Array();for(var g in d){h[d[g]]==undefined?h[d[g]["name"]]=g:null}for(var f in c){h[c[f]["name"]]==null?m.push(c[f]):h[c[f]["name"]]=-1}for(var e in h){h[e]>=0?l.push(d[h[e]]):null}return[l,m]};a.modules={};a.modules.Module=function(c){var d=c.period||c.timeout||45;this.nextTimeout=function(e){if(e){d=e}else{return d}}};b.spotterjs=a;b.Spotter=a.Spotter})(window);(function(a){if(!spotterjs){throw new Error("spotterjs not yet loaded!")}if(!spotterjs.util){throw new Error("spotterjs.util not yet loaded!")}if(!spotterjs.modules){spotterjs.modules={}}else{if(typeof spotterjs.modules!="object"){throw new Error("spotterjs.modules is not an object!")}}if(!spotterjs.modules.delicious){spotterjs.modules.delicious={}}else{if(typeof spotterjs.modules.delicious!="object"){throw new Error("spotterjs.modules.delicious is not an object!")}}spotterjs.modules.delicious.recent=function(b){spotterjs.modules.Module.call(this,b);var c;this.url=function(){var e="http://feeds.delicious.com/v2/json/recent/?count=100";return e};this.process=function(g){var e={};if(c===undefined){c=g[0];e={data:g,update:true}}else{if(c.u===g[0]["u"]){e={data:g,update:false}}else{pops=g.length-d(c,g);for(var f=0;f<pops;f++){g.pop()}e={data:g,update:true};c=g[0]}}return e};var d=function(f,g){for(var e=0;e<g.length;++e){if(g[e]["u"]===f.u){return e}}return g.length}};spotterjs.modules.delicious.tags=function(c){spotterjs.modules.Module.call(this,c);var b=c.tags;if(b===undefined||b===""){throw new Error("delicious tags module requires tags to be specified as an option")}var d;this.url=function(){var f="http://feeds.delicious.com/v2/json/tag/"+b+"?count=100";return f};this.process=function(h){var f={};if(d===undefined){d=h[0];f={data:h,update:true}}else{if(d.u===h[0]["u"]){f={data:h,update:false}}else{pops=h.length-e(d,h);for(var g=0;g<pops;g++){h.pop()}f={data:h,update:true};d=h[0]}}return f};var e=function(g,h){for(var f=0;f<h.length;++f){if(h[f]["u"]===g.u){return f}}return h.length}}})(window);(function(a){if(!spotterjs){throw new Error("spotter not yet loaded!")}if(!spotterjs.util){throw new Error("spotter.util not yet loaded!")}if(!spotterjs.modules){spotterjs.modules={}}else{if(typeof spotterjs.modules!="object"){throw new Error("spotterjs.modules is not an object!")}}if(!spotterjs.modules.facebook){spotterjs.modules.facebook={}}else{if(typeof spotterjs.modules.facebook!="object"){throw new Error("spotterjs.modules.facebook is not an object!")}}spotterjs.modules.facebook.search=function(d){spotterjs.modules.Module.call(this,d);var c=d.q;var b=null;var e;if(c===undefined||c===""){throw new Error("facebook search module requires a search string (q) to be specified as an option")}this.url=function(){var f="http://graph.facebook.com/search";f+="?q="+escape(c);return f};this.process=function(g){var f={};f.data=[];for(e in g.data){if((b===null||g.data[e].created_time>b)&&g.data[e].type==="status"){g.data[e].profile_image_url="http://graph.facebook.com/"+g.data[e].from.id+"/picture";g.data[e].profile_url="http://www.facebook.com/people/"+g.data[e].from.name.replace(" ","-")+"/"+g.data[e].from.id;f.data.push(g.data[e])}else{}}b=g.data[0]["created_time"];f.update=(f.data.length>0)?true:false;return f}}})(window);(function(a){if(!spotterjs){throw new Error("spotter not yet loaded!")}if(!spotterjs.modules){spotterjs.modules={}}else{if(typeof spotterjs.modules!="object"){throw new Error("spotterjs.modules is not an object!")}}if(!spotterjs.modules.flickr){spotterjs.modules.flickr={}}else{if(typeof spotterjs.modules.flickr!="object"){throw new Error("spotterjs.modules.flickr is not an object!")}}spotterjs.modules.flickr.search=function(d){spotterjs.modules.Module.call(this,d);if(d==undefined||d.api_key==undefined||(d.q==undefined&&d.tags==undefined)){throw new Error("flickr search module requires an api_key and a search string (q) or tags to be defined as an option")}var g=d.api_key;var c=d.q;var b=d.tags;var f={id:-1};this.url=function(){var h="http://api.flickr.com/services/rest/?method=flickr.photos.search";h+="&api_key="+g+"&format=json&content_type=1";if(b!=undefined){h+="&tags="+escape(b)}if(c!=undefined){h+="&text="+escape(c)}return{url:h,callbackParam:"jsoncallback"}};this.process=function(l){var h={};h.data=[];var k=l.photos.photo;var j;for(j=0;j<k.length&&k[j].id!==f.id;j++){k[j].url=e(k[j]);k[j].user_url="http://www.flickr.com/"+k[j].owner;k[j].photo_url="http://www.flickr.com/"+k[j].owner+"/"+k[j].id;h.data.push(k[j])}f=k[0];h.update=(h.data.length>0)?true:false;return h};var e=function(i){var h="http://farm"+i.farm+".static.flickr.com/"+i.server+"/"+i.id+"_"+i.secret+".jpg";return h}};spotterjs.modules.flickr.feeds=function(c){spotterjs.modules.Module.call(this,c);var b=c.tags||null;var d={id:-1};this.url=function(){var e="http://api.flickr.com/services/feeds/photos_public.gne?format=json";if(b!==null){e+="&tags="+escape(b)}return{url:e,callbackParam:"jsoncallback"}};this.process=function(h){var e={};e.data=[];var g=h.items;var f;for(f=0;f<g.length&&g[f].link!==d.link;f++){g[f].url=g[f].media.m.replace("_m","");g[f].user_url="http://www.flickr.com/"+g[f].author_id;g[f].photo_url=g[f].link;if(g[f].author.match(/\(([^\)]*)\)/)===null){alert(g[f].author)}g[f].user_id=g[f].author.match(/\(([^\)]*)\)/)[1];e.data.push(g[f])}d=g[0];e.update=(e.data.length>0)?true:false;return e}}})(window);(function(a){if(!spotterjs){throw new Error("spotterjs not yet loaded!")}if(!spotterjs.util){throw new Error("spotterjs.util not yet loaded!")}if(!spotterjs.modules){spotterjs.modules={}}else{if(typeof spotterjs.modules!="object"){throw new Error("spotterjs.modules is not an object!")}}if(!spotterjs.modules.identica){spotterjs.modules.identica={}}else{if(typeof spotterjs.modules.identica!="object"){throw new Error("spotterjs.modules.identica is not an object!")}}spotterjs.modules.identica.search=function(d){spotterjs.modules.Module.call(this,d);var c="";var b=d.q;var e=0;if(b===undefined||b===""){throw new Error("identica search module requires a search string (q) to be specified as an option")}this.url=function(){var f="http://identi.ca/api/search.json";f+=c!=""?c:"?q="+escape(b);return f};this.process=function(h){var f={};var g;f.data=[];c=h.refresh_url;if(h.results.length>0){f.update=true;for(g=0;g<h.results.length&&h.results[g].id>e;++g){f.data.unshift(h.results[g])}e=h.results[0].id}else{f.update=false}return f}};spotterjs.modules.identica.realtimesearch=function(c){spotterjs.modules.Module.call(this,c);var b=c.q;var f=0;var e=1000;var d=[0,0,e];if(b===undefined||b===""){throw new Error("identica search module requires searchString to be specified as an option")}this.url=function(){var g="http://identi.ca/api/statuses/public_timeline.json?count="+e;return g};this.process=function(j){var g={};var h;if(f>0){d.push(j[0].id-f);d.shift();e=Math.ceil((d[0]+d[1]+d[2])/3)+10}g.data=[];if(j.length>0){for(h=0;h<j.length&&j[h].id>f;++h){if(j[h].text.match(new RegExp(b,"i"))){g.data.unshift(j[h])}}f=j[0].id;g.update=g.data.length===0?false:true}else{g.update=false}return g}}})(window);(function(a){if(!spotterjs){throw new Error("spotterjs not yet loaded!")}if(!spotterjs.util){throw new Error("spotterjs.util not yet loaded!")}if(!spotterjs.modules){spotterjs.modules={}}else{if(typeof spotterjs.modules!="object"){throw new Error("spotterjs.modules is not an object!")}}if(!spotterjs.modules.twitpic){spotterjs.modules.twitpic={}}else{if(typeof spotterjs.modules.twitpic!="object"){throw new Error("spotterjs.modules.twitpic is not an object!")}}spotterjs.modules.twitpic.search=function(d){spotterjs.modules.Module.call(this,d);var c="";var b=d.q;if(b===undefined||b===""){throw new Error("twitpic search module requires a search string (q) to be specified as an option")}this.url=function(){var e="http://search.twitter.com/search.json";e+=c!=""?c:"?q="+escape(b)+"+twitpic";return e};this.process=function(j){var f={};var g;var h;var e;c=j.refresh_url||"";f.update=(j.results.length>0)?true:false;f.data=[];for(g in j.results){h=/http\:\/\/twitpic.com\/(\w+)/.exec(j.results[g].text);if(h!==null&&!j.results[g].text.match(new RegExp("^RT"))){e=h[1];j.results[g].twitpic_url="http://twitpic.com/"+e;j.results[g].twitpic_full_url="http://twitpic.com/show/full/"+e;j.results[g].twitpic_thumb_url="http://twitpic.com/show/thumb/"+e;j.results[g].twitpic_mini_url="http://twitpic.com/show/mini/"+e;f.data.push(j.results[g])}}return f}}})(window);(function(a){if(!spotterjs){throw new Error("spotterjs not yet loaded!")}if(!spotterjs.util){throw new Error("spotterjs.util not yet loaded!")}if(!spotterjs.modules){spotterjs.modules={}}else{if(typeof spotterjs.modules!="object"){throw new Error("spotterjs.modules is not an object!")}}if(!spotterjs.modules.twitter){spotterjs.modules.twitter={}}else{if(typeof spotterjs.modules.twitter!="object"){throw new Error("spotterjs.modules.twitter is not an object!")}}spotterjs.modules.twitter.search=function(e){spotterjs.modules.Module.call(this,e);var d="";var c=e.q;var b=(e.exclude!==undefined)?e.exclude.split(","):[];var h=e.lang;var g;var f="";if(c===undefined||c===""){throw new Error("twitter search module requires a search string (q) to be specified as an option")}if(b!==undefined){for(g=0;g<b.length;g++){if(b[g]==="twitpic"||b[g]==="tweetphoto"){f+=(f==="")?b[g]:"|"+b[g]}else{throw new Error(b[g]+" not a valid exclude string, try 'tweetphoto' and/or 'twitpic'")}}}this.url=function(){var i="http://search.twitter.com/search.json";i+=(d!=="")?d:"?q="+escape(c);i+=(h)?"&lang="+h:"";return i};this.process=function(k){var i={};d=k.refresh_url||"";if(f===""){i.data=k.results}else{i.data=[];var j=new RegExp(f);for(g in k.results){if(k.results[g].text.match(j)===null){i.data.push(k.results[g])}else{}}}i.update=(i.data.length>0)?true:false;return i}};spotterjs.modules.twitter.trends=function(b){spotterjs.modules.Module.call(this,b);var c;this.url=function(){var d="http://api.twitter.com/trends.json?";if(b!=undefined&&b.exclude!=undefined){d+="exclude="+b.exclude}return d};this.process=function(g){var d={};var f=g.trends;if(c===null){d={data:{added:g.trends,removed:{},trends:g.trends}}}else{var e=spotterjs.util.complements(g.trends,c);d={data:{added:e[0],removed:e[1],trends:g.trends}}}c=g.trends;d.update=(d.data.added.length>0||d.data.removed.length>0)?true:false;return d}}})(window);